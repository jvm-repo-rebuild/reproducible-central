#!/bin/bash

# Output of update-java-alternatives -l
#java-1.11.0-openjdk-amd64      1111       /usr/lib/jvm/java-1.11.0-openjdk-amd64
#java-1.17.0-openjdk-amd64      1711       /usr/lib/jvm/java-1.17.0-openjdk-amd64
#java-1.8.0-openjdk-amd64       1081       /usr/lib/jvm/java-1.8.0-openjdk-amd64

(
echo '<?xml version="1.0" encoding="UTF8"?>'
echo "<!-- Generated by $0 on $(date) -->"
echo '<toolchains>'
update-java-alternatives -l | while read line ;
  do
    JDK=$(echo "${line}" | sed 's/ \+/ /g' | cut -d' ' -f1)
    JDKDIR=$(echo "${line}" | sed 's/ \+/ /g' | cut -d' ' -f3)
    JDKVERSION=$(echo "${JDK}" | sed 's/^java-1\.\([0-9]\+\)\..*/\1/g')

    echo '  <toolchain>'
    echo '    <type>jdk</type>'
    echo '    <provides>'
    echo '      <version>'"${JDKVERSION}"'</version>'
    echo '    </provides>'
    echo '    <configuration>'
    echo '      <jdkHome>'"${JDKDIR}"'</jdkHome>'
    echo '    </configuration>'
    echo '  </toolchain>'
  done
echo '</toolchains>'
)